here is the register procedure.